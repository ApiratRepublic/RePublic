V1 (2025-10-31)
This python script is for my friends at PSVD
(Psychosis Sanctified of Voiceless Despair)

## ประเภทของฟีเจอร์คลาส
ตรวจสอบฟีเจอร์คลาสในจีดีบีจำนวนมาก โดยเจาะจงเฉพาะที่ชื่ออยู่ในรูปแบบดังต่อไปนี้

1) “PARCEL” = Featureclass ที่มีชื่อในรูปแบบ "PARCEL_zone_provincecode" เช่น PARCEL_47_50 หรือ PARCEL_48_40 เป็นต้น
2) “PARCEL_NS3K”  = Featureclass ที่มีชื่อในรูปแบบ "PARCEL_zone_NS3K_provincecode" เช่น  PARCEL_47_NS3K_50 หรือ PARCEL_48_NS3K_40 เป็นต้น
3) “ROAD” = Featureclass ที่มีชื่อในรูปแบบ "ROAD_zone" เช่น ROAD_47 หรือ ROAD_48 เป็นต้น
4) “BLOCK_FIX”= Featureclass ที่มีชื่อในรูปแบบ "BLOCK_FIX_zone" เช่น BLOCK_FIX_47 หรือ BLOCK_FIX_48 เป็นต้น
5) "BLOCK_PRICE” Featureclass ที่มีชื่อในรูปแบบ "BLOCK_PRICE_zone" เช่น BLOCK_PRICE_47 หรือ BLOCK_PRICE_48 เป็นต้น
6) “BLOCK_BLUE”- Featureclass ที่มีชื่อในรูปแบบ "BLOCK_BLUE_zone" ตัวอย่างเช่น BLOCK_BLUE_47 หรือ BLOCK_BLUE_48 เป็นต้น
7) “PARCEL_REL”= Featureclass ที่มีชื่อในรูปแบบ "PARCEL_REL_zone" เช่น PARCEL_REL_47 หรือ PARCEL_REL_48 เป็นต้น
8) “NS3K_REL” = Featureclass ที่มีชื่อในรูปแบบ "NS3K_REL_zone" เช่น NS3K_REL_47 หรือ NS3K_REL_48 เป็นต้น

## สิ่งที่ตรวจสอบ
### 1. PARCEL

1.1. ประเภทข้อมูลของแต่ละฟิลด์:
	**1.1.1. UTMMAP1** ต้องเป็น String และเป็น 4 หลักเท่านั้น เช่น "5042"
	**1.1.2.UTMMAP2**  ต้องเป็น  Number และต้องเป็น 1 หรือ 2 หรือ 3 หรือ 4 เท่านั้น
	**1.1.3.UTMMAP3**  ต้องเป็น String และเป็น 4 หลักเท่านั้น เช่น "0016"
	**1.1.4.UTMMAP4**  ต้องเป็น String  และเป็น 2 หลักเท่านั้น เช่น "02"
		1.1.4.1. ถ้า UTMMAP SCALE = 4000 ต้องเป็น "00" เท่านั้น
		1.1.4.2. ถ้า UTMMAP SCALE = 2000 ต้องเป็น "01" -  "04" เท่านั้น
		1.1.4.3. ถ้า UTMMAP SCALE = 1000 ต้องเป็น “01”- “16” เท่านั้น
		1.1.4.4. ถ้า UTMMAP SCALE = 500 ต้องเป็น “01” – “64” เท่านั้น
	**1.1.5.UTMSCALE**  ต้องเป็น Number และเป็น  4000 หรือ 2000 หรือ 1000 หรือ 500 เท่านั้น
	**1.1.6.LAND_NO**  ต้องเป็น Number
	**1.1.7.PARCEL_TYPE** ต้องเป็น Number
	**1.1.8.CHANGWAT_CODE** ต้องเป็น String และเป็น 2 หลัก เช่น "66"
	**1.1.9.BRANCH_CODE** ต้องเป็น String และเป็น 8 หลัก และสองหลักแรก จะต้องตรงกับ CHANGWAT_CODE เช่น CHANGWAT_CODE  เป็น "66" BRANCHCODE จะต้องขึ้นต้นด้วยเลข 66 เช่น "66000000"
	**1.1.10.PARCEL_RN** ต้องเป็น Number และใน BRANCH_CODE เดียวกัน จะต้องไม่มีค่าซ้ำ
1.2. ถ้า LAND_NO ไม่ใช่ค่าว่าง หรือ 0: ให้ตรวจสอบ BRANCH_CODE, UTMMAP1, UTMMAP2, UTMMAP3, UTMMAP4, UTMSCALE และ LAND_NO จะต้องไม่ซ้ำกัน
1.3. ตรวจสอบโพลีกอนที่ซ้อนทับกันสนิท

### 2.PARCEL_NS3K

2.1. ประเภทข้อมูลของแต่ละฟิลด์:	
	**2.1.1. UTMMAP1** ต้องเป็น String และเป็น 4 หลักเท่านั้น เช่น "5042"
	**2.1.2. UTMMAP2** ต้องเป็น  Number  และต้องเป็น 1 หรือ 2 หรือ 3 หรือ 4 เท่านั้น
	**2.1.3. UTMMAP3** ต้องเป็น String และเป็น "0000"
	**2.1.4. UTMMAP4** ต้องเป็น String และเป็น 3 หลักเท่านั้น เช่น "002"
	**2.1.5. UTMSCALE** ต้องเป็น Number และเป็น 5000 เท่านั้น
	**2.1.6. LAND_NO** ต้องเป็น Number
	**2.1.7. PARCEL_TYPE** ต้องเป็น Number และเป็น 3 เท่านั้น
	**2.1.8. CHANGWAT_CODE** ต้องเป็น String และเป็น 2 หลัก เช่น "66"
	**2.1.9. BRANCH_CODE** ต้องเป็น String  และเป็น 8 หลัก และสองหลักแรก จะต้องตรงกับ   CHANGWAT_CODE
	**2.1.10. NS3K_RN**  ต้องเป็น Number และใน BRANCH_CODE เดียวกัน จะต้องไม่มีค่าซ้ำ
2.2. ถ้า LAND_NO ไม่ใช่ค่าว่าง หรือ 0 ให้ตรวจสอบ BRANCH_CODE, UTMMAP1, UTMMAP2, UTMMAP3, UTMMAP4, UTMSCALE และ LAND_NO จะต้องไม่ซ้ำกัน
2.3. ตรวจสอบโพลีกอนที่ซ้อนทับกันสนิท

### 3. ROAD

3.1. ประเภทข้อมูลของแต่ละฟิลด์:
	**3.1.1. STREET_NAME** ต้องเป็น String ถ้า TD_RP3_TYPE_CODE เป็น 1 หรือ 2 หรือ 3 หรือ 4 หรือ 5 หรือ 6 หรือ 8 จะต้องไม่ใช่ค่าว่าง
	**3.1.2. STREET_CODE** ต้องเป็น String
	**3.1.3 STREET_DEPTH** ต้องเป็น Number
	**3.1.4 LAND_USE** ต้องเป็น String  และ จะเป็นค่าว่างได้ก็ต่อเมื่อ STEET_NAME เป็นค่าว่าง มิเช่นนั้น จะต้องมีค่าเป็นข้อความดังต่อไปนี้ เท่านั้น
		- พาณิชยกรรม
		- อุตสาหกรรม
		- พาณิชยกรรมและที่อยู่อาศัย
		- ที่อยู่อาศัย
		- ที่อยู่อาศัยและเกษตรกรรม
		- ส่วนราชการ
		- เกษตรกรรม
		- พื้นที่ป่าสงวน
		- พื้นที่อุทยาน
	**3.1.5. STREET_TYPE** ต้องเป็น String ให้มีค่าว่างได้ถ้า STEET_NAME ว่าง และมีค่าเป็นข้อความดังต่อไปนี้ เท่านั้น
		- คอนกรีต
		- ลาดยาง
		- หินคลุก
		- ลูกรัง
		- ดิน
		- น้ำ
		- ไม้
		- ทางไม่มีสภาพ
	**3.1.6. STREET_WIDTH** ต้องเป็น Number
	**3.1.7. STREET_AREA** ต้องเป็น Number
	**3.1.8. CHANGWAT_CODE** ต้องเป็น String และเป็น 2 หลัก
	**3.1.9. BRANCH_CODE** ต้องเป็น String  และเป็น 8 หลัก และสองหลักแรก จะต้องตรงกับ   CHANGWAT_CODE
	**3.1.10. PARCEL_TYPE** ต้องเป็น Number
	**3.1.11. TD_RP3_TYPE_CODE** ต้องเป็น Number และจะต้องเป็น 1 หรือ 2 หรือ 3 หรือ 4 หรือ 5 หรือ 6 หรือ 8 เท่านั้น แต่ถ้า STREET_NAME เป็นค่าว่าง อนุญาตให้เป็นค่าว่าง หรือค่า 0 ได้
	**3.1.12. STREET_RN** ต้องเป็น Number  และใน BRANCH_CODE เดียวกัน จะต้องไม่มีค่าซ้ำ
	**3.1.13. STREET_SMG** ต้องเป็น String 
3.2. STREET_NAME และ STREET_CODE ต้องจับคู่กันแบบ 1 ต่อ 1 ภายใน BRANCH_CODE
3.3. ตรวจสอบโพลีกอนที่ซ้อนทับกันสนิท
### 4. BLOCK FIX

4.1. ประเภทข้อมูลของแต่ละฟิลด์:
	**4.1.1. STREET_NAME** ต้องเป็น String และไม่ใช่ค่าว่าง (NULL) หรือ " " หรือขีดกลาง (-)
	**4.1.2. STREET_CODE** ต้องเป็น String
	**4.1.3. BRANCH_CODE** ต้องเป็น String และมี 8 หลักเท่านั้น
	**4.1.4. BLOCK_FIX_RN** ต้องเป็น Number และใน BRANCH_CODE เดียวกัน ต้องไม่ซ้ำกัน
4.2.  STREET_NAME และ STREET_CODE ต้องจับคู่กันแบบ 1 ต่อ 1 ภายใน BRANCH_CODE
4.3. ตรวจสอบโพลีกอนที่ซ้อนทับกันสนิท
### 5. BLOCK PRICE

5.1. ประเภทข้อมูลของแต่ละฟิลด์:
	**5.1.1. STREET_NAME** ต้องเป็น String และไม่ใช่ค่าว่าง (NULL) หรือ " " หรือขีดกลาง (-)
	**5.1.2. STREET_CODE** ต้องเป็น String
	**5.1.3. BRANCH_CODE** ต้องเป็น String  และมี 8 หลักเท่านั้น
	**5.1.4. BLOCK_PRICE_RN** ต้องเป็น Number และใน BRANCH_CODE เดียวกัน ต้องไม่ซ้ำกัน
5.2. ตรวจสอบโพลีกอนที่ซ้อนทับกันสนิท

### 6. BLOCK BLUE

6.1. ประเภทข้อมูลของแต่ละฟิลด์:
	**6.1.1. BRANCH_CODE** ต้องเป็น String และมี 8 หลักเท่านั้น
	**6.1.2. BLOCK_BLUE_RN**  ต้องเป็น Number และใน BRANCH_CODE เดียวกัน ต้องไม่ซ้ำกัน
	**6.1.3. BLOCK_TYPE_ID**  ต้องเป็น Number และต้องเป็น 1 หรือ 2 หรือ 3 เท่านั้น
6.2. ตรวจสอบโพลีกอนที่ซ้อนทับกันสนิท

### 7. PARCEL_REL

7.1. ประเภทข้อมูลของแต่ละฟิลด์:
	**7.1.1. BRANCH_CODE** ต้องเป็น String  และมี 8 หลักเท่านั้น
	**7.1.2. REL_RN** ต้องเป็น Number    และใน BRANCH_CODE เดียวกันจะต้องไม่ซ้ำกัน
	**7.1.3. PARCEL_RN** ต้องเป็น Number
	**7.1.4. STREET_RN** ต้องเป็น Number
	**7.1.5. BLOCK_FIX_RN** ต้องเป็น Number
	**7.1.6. BLOCK_BLUE_RN** ต้องเป็น Number
	**7.1.7. BLOCK_PRICE_RN** ต้องเป็น Number
	**7.1.8. TABLE_NO** ต้องเป็น Number และมีค่าเป็น 1 หรือ 2 หรือ 3 หรือ 41 หรือ 42 หรือ 5 หรือ 6 หรือ 7 เท่านั้น
	**7.1.9. SUB_TABLE_NO** ต้องเป็น Number และต้องมีค่าระหว่าง 0 - 6 หรือค่าว่าง เท่านั้น
	**7.1.10.  DEPTH_R** ต้องเป็น Number ต้องไม่ใช่ 0 หรือว่าง
	**7.1.11. DEPTH_GROUP** ต้องเป็น Number
	**7.1.12. START_X** ต้องเป็น Number ต้องไม่ใช่ 0 หรือว่าง
	**7.1.13. START_Y** ต้องเป็น Number ต้องไม่ใช่ 0 หรือว่าง
	**7.1.14. END_X** ต้องเป็น Number ต้องไม่ใช่ 0 หรือว่าง
	**7.1.15. END_Y** ต้องเป็น Number ต้องไม่ใช่ 0 หรือว่าง

### 8. NS3K_REL

8.1. ประเภทข้อมูลของแต่ละฟิลด์:
	**8.1.1. BRANCH_CODE** ต้องเป็น String และมี 8 หลักเท่านั้น
	**8.1.2. REL_RN** ต้องเป็น Number และภายใน BRANCH_CODE เดียวกันจะต้องไม่ซ้ำกัน
	**8.1.3 NS3K_RN** ต้องเป็น Number
	**8.1.4. STREET_RN** ต้องเป็น Number
	**8.1.5. BLOCK_FIX_RN** ต้องเป็น Number
	**8.1.6. BLOCK_BLUE_RN** ต้องเป็น Number
	**8.1.7. BLOCK_PRICE_RN** ต้องเป็น Number
	**8.1.8. TABLE_NO** ต้องเป็น Number และมีค่าเป็น 1 หรือ 2 หรือ 3 หรือ 41 หรือ 42 หรือ 5 หรือ 6 หรือ 7 เท่านั้น
	**8.1.9. SUB_TABLE_NO** ต้องเป็น Number และต้องมีค่าระหว่าง 0 – 6 หรือค่าว่าง เท่านั้น
	**8.1.10.  DEPTH_R** ต้องเป็น Number ต้องไม่ใช่ 0 หรือว่าง
	**8.1.11. DEPTH_GROUP** ต้องเป็น Number
	**8.1.12. START_X** ต้องเป็น Number ต้องไม่ใช่ 0 หรือว่าง
	**8.1.13. START_Y** ต้องเป็น Number ต้องไม่ใช่ 0 หรือว่าง
	**8.1.14. END_X** ต้องเป็น Number ต้องไม่ใช่ 0 หรือว่าง
	**8.1.15. END_Y** ต้องเป็น Number ต้องไม่ใช่ 0 หรือว่าง

## รายงาน

### 1) รายงาน Errors
แสดงรายละเอียดที่พบว่าไม่ตรงตามมาตรฐานที่กำหนด แยกรายงานเป็น 1 ไฟล์ต่อ 1 gdb ที่ตรวจสอบ

ในรายงาน แยกเป็นชีต 8 ชีต ตามประเภทของฟีเจอร์คลาส
1) “PARCEL
2) “PARCEL_NS3K
3) “ROAD”
4) “BLOCK_FIX
5) "BLOCK_PRICE”
6) “BLOCK_BLUE”
7) “PARCEL_REL”
8) “NS3K_REL”

โดยใช้คอลัมน์ดังต่อไปนี้
	**Timestamp** – วัน-เวลาที่สร้างรายงาน เช่น “2025-10-27 09:17:55”
	**GDB** – ชื่อ gdb ที่ตรวจสอบ เช่น “50_เชียงใหม่\GDB_50_3”
	**Featureclass** - ชื่อฟีเจอร์คลาสที่ตรวจสอบ เช่น “PARCEL_REL_47”
	**Check_Type** – ประเภทการตรวจสอบ
		*Field Check* = ตรวจสอบว่ามีฟิลด์ที่กำหนดในแต่ละฟีเจอร์คลาสหรือไม่
		*Field Type* = ประเภทข้อมูล เช่น string หรือ number ตามข้อกำหนด
		*Data Forma*t = รูปแบบตรงตามที่กำหนด เช่น BRANCH_CODE ต้องมี 8 หลัก
		*Conditional Rule* = การใส่ข้อมูลไม่เป็นตามเงื่อนไข เช่น กำหนดว่า UTMSCALE=2000" UTMMAP4 ต้องอยู่ระหว่าง '01'-'04'
		*Duplicate UTM* = primary_key (7 คีย์หลัก) ซ้ำ
		*Duplicate Value* = พบค่าซ้ำ
		*Data Required* = ค่าที่จำเป็นต้องใส่ ไม่ใช่ค่าว่าง เช่น เมื่อ TD_RP3_TYPE_CODE มีค่าตามที่กำหนด STREET NAME จะต้องไม่เป็นค่าว่าง
		*Data Specified* = ต้องใส่ค่าเฉพาะที่กำหนด เช่น LAND_USE จะต้องเป็น “ที่อยู่อาศัย”, “พาณิชยกรรม” ฯลฯ
		*OneToOne* กรณีกำหนดความสัมพันธ์ระหว่าง 2 ฟิลด์ว่าต้องเป็นแบบ 1 ต่อ 1 เช่น STREET_NAME กับ STREET_CODE
		*Overlap Check Error* = ฟีเจอร์คลาสมีปัญหา ไม่สามารถตรวจสอบโพลีกอนซ้อนทับกันได้
		*Duplicated Polygo*n = พบโพลีกอนที่ซ้อนทับกันสนิท
		*Geometry Error* = มีปัญหาเรื่อง Geometry
		*Cursor Error* = มีปัญหาการดำเนินการจาก Arcpy
		*Validator Error*= กระบวนการตรวจสอบล้มเหลว (ปัญหาจากสคริปต์ไพธอน)
	**Object_ID(s)** – Object ID ที่พบปัญหา
	**Field_Name** - ชื่อฟิลด์ที่พบปัญหา
	**Invalid_Value** - ค่าที่เป็นปัญหา
	**Message** - อธิบายว่า ปัญหาคืออะไร

### รายงาน Summary

ในรายงาน Summary จะประกอบด้วย 3 ชีต
#### All Data (รายงานข้อมูลที่ตรวจสอบทั้งหมด)
- **Timestamp** = วันเวลาที่สร้างรายงาน
- **GDB_Path** = GDB ที่ดำเนินการตรวจสอบ
- **Featureclass** = ชั้น featureclass ที่ตรวจสอบ
- **Count of Polygon or Polyline** = จำนวนโพลีกอนหรือโพลีไลน์ที่ตรวจสอบทั้งหมด
#### Error SUM (รายงานสรุปสิ่งที่ไม่ตรงมาตรฐานแยกตามจีดีบีและประเภทที่พบ)
- **Timestamp**  = วันเวลาที่สร้างรายงาน
- **GDB_Path** = GDB ที่ดำเนินการตรวจสอบ
- **Featureclass** = ชั้น featureclass
- **Check_Type** = ประเภทการตรวจสอบ
- **Count of Errors** = จำนวนเรื่องไม่ตรงมาตรฐานที่พบ

#### Report by Province (รายงานสรุปเรื่องไม่ตรงมาตรฐานของแต่ละจังหวัด)
- **Province**  = จังหวัด
- **BLOCK_BLUE** = รวมจำนวนรายงานผลความคลาดเคลื่อนของฟีเจอร์คลาสประเภทนี้ภายในจังหวัด
- **BLOCK_FIX** = รวมจำนวนรายงานผลความคลาดเคลื่อนของฟีเจอร์คลาสประเภทนี้ภายในจังหวัด
- **BLOCK_PRICE** = รวมจำนวนรายงานผลความคลาดเคลื่อนของฟีเจอร์คลาสประเภทนี้ภายในจังหวัด
- **NS3K** = รวมจำนวนรายงานผลความคลาดเคลื่อนของฟีเจอร์คลาสประเภทนี้ภายในจังหวัด
- **NS3K_REL** = รวมจำนวนรายงานผลความคลาดเคลื่อนของฟีเจอร์คลาสประเภทนี้ภายในจังหวัด
- **PARCEL** = รวมจำนวนรายงานผลความคลาดเคลื่อนของฟีเจอร์คลาสประเภทนี้ภายในจังหวัด
- **PARCEL_REL** = รวมจำนวนรายงานผลความคลาดเคลื่อนของฟีเจอร์คลาสประเภทนี้ภายในจังหวัด
- **ROAD** = รวมจำนวนรายงานผลความคลาดเคลื่อนของฟีเจอร์คลาสประเภทนี้ภายในจังหวัด
